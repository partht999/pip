<html>
<head>
    <title>Python Code Display</title>
</head>
<body>

<pre><code>

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

df = sns.load_dataset('titanic')
df = df[['pclass','age','sibsp','fare']].dropna()

X = df[['pclass','age','sibsp']].values
Y = df[['fare']].values


X_b = np.c_[np.ones((len(X),1)), X]


theta = np.linalg.inv(X_b.T @ X_b) @ X_b.T @ Y


intercept = float(theta[0])
coefficients = theta[1:].flatten()


features = ['pclass','age','sibsp']

print(f"Intercept: {intercept:.4f}")
for i, col in enumerate(features):
    print(f"Coefficient for {col}: {coefficients[i]:.4f}")


Y_pred = X_b @ theta


results = pd.DataFrame({"Actual": Y.flatten(), "Predicted": Y_pred.flatten()})
print("\nActual vs Predicted (first 5 rows):")
print(results.head())

residuals = Y.flatten() - Y_pred.flatten()


SS_res = np.sum(residuals**2)
SS_tot = np.sum((Y - np.mean(Y))**2)
R2 = 1 - (SS_res / SS_tot)
print(f"\nRÂ² Score: {R2:.4f}")


plt.figure(figsize=(6,4))
plt.scatter(Y, Y_pred, color='orange')

min_val = min(min(Y), min(Y_pred))
max_val = max(max(Y), max(Y_pred))

plt.plot([min_val, max_val], [min_val, max_val], color='blue')
plt.title("Actual vs Predicted")
plt.xlabel("Actual Values")
plt.ylabel("Predicted Values")
plt.grid(True)
plt.show()

</code></pre>

</body>
</html>
