<html>
<head>
    <title>Python Code Display</title>
</head>
<body>

<pre><code>
# independent and dependent
X = df1["age"].values
Y = df1["fare"].values

# add intercept
X_b = np.c_[np.ones((len(X),1)), X]

# linear regression closed form
theta_best = np.linalg.inv(X_b.T.dot(X_b)).dot(X_b.T).dot(Y)

intercept, slope = theta_best
print("Intercept:", intercept)
print("Slope:", slope)

# predictions for plotting
Y_pred = intercept + slope * X

plt.figure(figsize=(6,4))
sns.scatterplot(x="age", y="fare", data=df1, label="Actual data")
plt.plot(X, Y_pred, label="Regression Line" , color='red')
plt.title("Titanic: Fare prediction from Age (df1)")
plt.legend()
plt.show()

# Residuals
residuals = Y - Y_pred

# R² Score
SS_res = np.sum(residuals**2)
SS_tot = np.sum((Y - np.mean(Y))**2)
R2 = 1 - (SS_res/SS_tot)
print("R² Score:", R2)
</code></pre>

</body>
</html>
