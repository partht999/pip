<html>
<head></head>

<body>
# independent and dependent <br>
X = df1["age"].values <br>
Y = df1["fare"].values <br>
# add intercept <br>
X_b = np.c_[np.ones((len(X),1)), X] <br>
# linear regression closed form <br>
theta_best = np.linalg.inv(X_b.T.dot(X_b)).dot(X_b.T).dot(Y) <br>
intercept, slope = theta_best <br>
print("Intercept:", intercept) <br>
print("Slope:", slope) <br>
# predictions for plotting <br>
Y_pred = intercept + slope * X <br><br>

plt.figure(figsize=(6,4)) <br>
sns.scatterplot(x="age", y="fare", data=df1, label="Actual data") <br>
plt.plot(X, Y_pred, label="Regression Line" , color = 'red') <br>
plt.title("Titanic: Fare prediction from Age (df1)") <br>
plt.legend() <br>
plt.show() <br><br>

# Residuals <br>
residuals = Y - Y_pred <br>
# R^2 Score <br>
SS_res = np.sum(residuals**2) <br>
SS_tot = np.sum((Y - np.mean(Y))**2) <br>
R2 = 1 - (SS_res/SS_tot) <br>
print("RÂ² Score:", R2) <br>
</body>


</html>
